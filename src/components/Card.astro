---
import { formatDate } from '@/utils/data.util';
import PinnedBadge from './PinnedBadge.astro';
import { Image } from 'astro:assets';

interface Props {
	post: {
		url: string;
		frontmatter: {
			title: string;
			isPinned: boolean;
			pubDate: string;
			minutesRead: string;
			excerpt: string;
			image: {
				src: string;
				alt: string;
			};
		};
	};
}

const origin = Astro.url.origin;
const { post } = Astro.props;
const isPinned = post.frontmatter.isPinned === true;
const image = post.frontmatter.image;
const imagePath = `${origin}/src/pages/posts/${image.src}`;
---

<a href={post.url}>
	<div class="h-full rounded-2xl p-1 text-sm dark:bg-gray-900">
		<div
			class="flex h-full flex-col rounded-2xl bg-gray-300 p-4 text-gray-900 opacity-90 dark:bg-gray-800 dark:text-white"
		>
			<div class="flex-auto">
				<div class="flex flex-col justify-between gap-2 pb-4 text-xs">
					<div class="flex justify-between gap-2">
						{isPinned && <PinnedBadge size="sm" />}

						<strong>{post.frontmatter.minutesRead}</strong>
						<p>{formatDate(post.frontmatter.pubDate)}</p>
					</div>
				</div>
			</div>

			{image.src ? <Image inferSize src={imagePath} alt={image.alt} /> : null}

			<p class="pb-4 text-lg font-bold">{post.frontmatter.title}</p>
			<p class="line-clamp-2">{post.frontmatter.excerpt}</p>
		</div>
	</div>
</a>
